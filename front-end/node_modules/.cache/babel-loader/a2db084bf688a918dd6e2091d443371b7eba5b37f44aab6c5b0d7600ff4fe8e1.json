{"ast":null,"code":"var _jsxFileName = \"C:\\\\icmp_events_api\\\\front-end\\\\src\\\\components\\\\BusinessDetailsView\\\\BusinessDetailsView.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport AgentSection from '../AgentSection';\nimport { Snackbar, Alert, Box, IconButton, Typography, Container, Paper, Button } from '@mui/material';\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\n\n// Define your backend API base URL\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API_BASE_URL = 'http://localhost:5000';\nfunction BusinessDetailsView() {\n  _s();\n  const navigate = useNavigate();\n  const [businessData, setBusinessData] = useState(null);\n  const [editFormData, setEditFormData] = useState({}); // State for form data\n  const [agents, setAgents] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [isEditing, setIsEditing] = useState(false);\n  const [snackbar, setSnackbar] = useState({\n    open: false,\n    message: '',\n    severity: 'success'\n  });\n\n  // Get the business ID from localStorage instead of hardcoding\n  const businessId = localStorage.getItem('businessId');\n  const handleSnackbarOpen = (message, severity = 'success') => {\n    setSnackbar({\n      open: true,\n      message,\n      severity\n    });\n  };\n  const handleSnackbarClose = () => {\n    setSnackbar({\n      ...snackbar,\n      open: false\n    });\n  };\n  const handleNavigateToLogin = () => {\n    navigate('/login');\n  };\n  const handleLogout = () => {\n    // Clear localStorage\n    localStorage.removeItem('userId');\n    localStorage.removeItem('businessId');\n    localStorage.removeItem('businessApiKey');\n\n    // Show logout message\n    handleSnackbarOpen('Logged out successfully', 'success');\n\n    // Navigate to login page\n    navigate('/login');\n  };\n  useEffect(() => {\n    const fetchData = async () => {\n      if (!businessId) {\n        setError(\"Please login to view business details.\");\n        setIsLoading(false);\n        return;\n      }\n      setIsLoading(true);\n      setError(null); // Clear previous errors\n      console.log(`Fetching data for business ID: ${businessId}`);\n      try {\n        // --- Fetch Business Details ---\n        const businessResponse = await fetch(`/businesses/${businessId}`, {\n          method: 'GET',\n          credentials: 'include',\n          // Important to send cookies\n          headers: {\n            'Accept': 'application/json'\n          }\n        });\n        if (!businessResponse.ok) {\n          const errorData = await businessResponse.json().catch(() => ({})); // Try to get error details\n          throw new Error(`HTTP error ${businessResponse.status}: ${errorData.error || errorData.message || 'Failed to fetch business details'}`);\n        }\n        const fetchedBusinessData = await businessResponse.json();\n        console.log(\"Fetched Business Data:\", fetchedBusinessData);\n        setBusinessData(fetchedBusinessData);\n        setEditFormData({\n          // Initialize form data when data is fetched\n          business_name: fetchedBusinessData.business_name || '',\n          business_description: fetchedBusinessData.business_description || '',\n          address: fetchedBusinessData.address || '',\n          phone_number: fetchedBusinessData.phone_number || '',\n          website: fetchedBusinessData.website || ''\n        });\n\n        // --- Fetch Agents ---\n        const agentsResponse = await fetch(`/agents?business_id=${businessId}`, {\n          method: 'GET',\n          credentials: 'include',\n          // Important to send cookies\n          headers: {\n            'Accept': 'application/json'\n          }\n        });\n        if (!agentsResponse.ok) {\n          const errorData = await agentsResponse.json().catch(() => ({}));\n          // Don't throw, maybe just log? Or set a separate error state?\n          console.error(`HTTP error ${agentsResponse.status}: ${errorData.message || 'Failed to fetch agents'}`);\n          setError(prev => prev ? `${prev} | Failed to fetch agents.` : \"Failed to fetch agents.\"); // Append or set error\n          setAgents([]); // Ensure agents list is empty on error\n        } else {\n          const fetchedAgents = await agentsResponse.json();\n          console.log(\"Fetched Agents:\", fetchedAgents);\n          setAgents(fetchedAgents);\n        }\n      } catch (err) {\n        console.error(\"Error fetching data:\", err);\n        setError(err.message || \"An unexpected error occurred while fetching data.\");\n        setBusinessData(null); // Clear data on error\n        setAgents([]);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    fetchData();\n  }, [businessId]); // Re-fetch if businessId changes\n\n  const handleInputChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setEditFormData(prevData => ({\n      ...prevData,\n      [name]: value\n    }));\n  };\n  const handleEditToggle = () => {\n    if (!isEditing && businessData) {\n      // Reset form data to current business data when entering edit mode\n      setEditFormData({\n        business_name: businessData.business_name || '',\n        business_description: businessData.business_description || '',\n        address: businessData.address || '',\n        phone_number: businessData.phone_number || '',\n        website: businessData.website || ''\n      });\n    }\n    setIsEditing(!isEditing);\n    setError(null); // Clear errors when toggling mode\n  };\n  const handleSaveChanges = async e => {\n    e.preventDefault(); // Prevent default form submission\n    setIsLoading(true); // Indicate saving process\n    setError(null);\n    console.log(\"Saving changes:\", editFormData);\n    try {\n      const response = await fetch(`${API_BASE_URL}/businesses/${businessId}`, {\n        method: 'PUT',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify(editFormData)\n      });\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(`HTTP error ${response.status}: ${errorData.message || 'Failed to save changes'}`);\n      }\n      const result = await response.json();\n      console.log(\"Save successful:\", result);\n\n      // Optimistically update local state, or re-fetch data\n      setBusinessData(prevData => ({\n        ...prevData,\n        ...editFormData\n      }));\n      setIsEditing(false);\n    } catch (err) {\n      console.error(\"Error saving changes:\", err);\n      setError(err.message || \"An unexpected error occurred while saving.\");\n    } finally {\n      setIsLoading(false); // Finish loading indicator\n    }\n  };\n  if (isLoading && !businessData) {\n    // Show initial loading\n    return /*#__PURE__*/_jsxDEV(Container, {\n      maxWidth: \"lg\",\n      sx: {\n        mt: 4,\n        mb: 4\n      },\n      children: /*#__PURE__*/_jsxDEV(Paper, {\n        sx: {\n          p: 3,\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center'\n        },\n        children: /*#__PURE__*/_jsxDEV(Typography, {\n          children: \"Loading business details...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Show error prominently if one occurred\n  if (error && !isEditing) {\n    // Don't block editing form with load errors\n    return /*#__PURE__*/_jsxDEV(Container, {\n      maxWidth: \"lg\",\n      sx: {\n        mt: 4,\n        mb: 4\n      },\n      children: /*#__PURE__*/_jsxDEV(Paper, {\n        sx: {\n          p: 3\n        },\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          color: \"error\",\n          children: [\"Error: \", error]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          color: \"primary\",\n          onClick: handleNavigateToLogin,\n          sx: {\n            mt: 2\n          },\n          children: \"Return to Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 7\n    }, this);\n  }\n  if (!businessData && !isLoading) {\n    // Handle case where loading finished but no data (and no specific load error)\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"No business data found or failed to load.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 14\n    }, this);\n  }\n  // Render component content only if businessData is available\n  if (!businessData) return null; // Or a placeholder/skeleton UI\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    maxWidth: \"lg\",\n    sx: {\n      mt: 4,\n      mb: 4\n    },\n    children: /*#__PURE__*/_jsxDEV(Paper, {\n      sx: {\n        p: 3,\n        mb: 4\n      },\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          display: 'flex',\n          alignItems: 'center',\n          mb: 3\n        },\n        children: [/*#__PURE__*/_jsxDEV(IconButton, {\n          onClick: handleLogout,\n          sx: {\n            mr: 1\n          },\n          children: /*#__PURE__*/_jsxDEV(ArrowBackIcon, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h5\",\n          gutterBottom: true,\n          sx: {\n            flexGrow: 1,\n            mb: 0\n          },\n          children: \"Business Details\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 9\n      }, this), isEditing && error && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          color: 'red',\n          marginBottom: '10px'\n        },\n        children: [\"Save Error: \", error]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 32\n      }, this), isEditing && isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"Saving...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 36\n      }, this), isEditing ?\n      /*#__PURE__*/\n      // --- Edit Mode ---\n      _jsxDEV(\"form\", {\n        onSubmit: handleSaveChanges,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"business_name\",\n            children: \"Name:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            id: \"business_name\",\n            name: \"business_name\",\n            value: editFormData.business_name,\n            onChange: handleInputChange,\n            required: true // Assuming name is required\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"business_description\",\n            children: \"Description:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 20\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            id: \"business_description\",\n            name: \"business_description\",\n            value: editFormData.business_description,\n            onChange: handleInputChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"address\",\n            children: \"Address:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 20\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            id: \"address\",\n            name: \"address\",\n            value: editFormData.address,\n            onChange: handleInputChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 16\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"phone_number\",\n            children: \"Phone:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 20\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"tel\" // Use tel type for phone numbers\n            ,\n            id: \"phone_number\",\n            name: \"phone_number\",\n            value: editFormData.phone_number,\n            onChange: handleInputChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 16\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"website\",\n            children: \"Website:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 20\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"url\" // Use url type for websites\n            ,\n            id: \"website\",\n            name: \"website\",\n            value: editFormData.website,\n            onChange: handleInputChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 285,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 16\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: isLoading,\n          children: \"Save Changes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          onClick: handleEditToggle,\n          disabled: isLoading,\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 11\n      }, this) :\n      /*#__PURE__*/\n      // --- View Mode ---\n      _jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Name:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 16\n          }, this), \" \", businessData.business_name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Description:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 16\n          }, this), \" \", businessData.business_description || '-']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Address:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 16\n          }, this), \" \", businessData.address || '-']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Phone:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 16\n          }, this), \" \", businessData.phone_number || '-']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Website:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 16\n          }, this), \" \", businessData.website ? /*#__PURE__*/_jsxDEV(\"a\", {\n            href: businessData.website,\n            target: \"_blank\",\n            rel: \"noopener noreferrer\",\n            children: businessData.website\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 66\n          }, this) : '-']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Business ID:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 16\n          }, this), \" \", businessData.business_id]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Owner ID:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 16\n          }, this), \" \", businessData.owner_id]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          sx: {\n            display: 'flex',\n            gap: 2,\n            mt: 2\n          },\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            color: \"primary\",\n            onClick: handleEditToggle,\n            children: \"Edit Details\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"outlined\",\n            color: \"error\",\n            onClick: handleLogout,\n            children: \"Logout\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(AgentSection, {\n        handleSnackbarOpen: handleSnackbarOpen,\n        onAgentSelect: agentId => console.log('Selected agent:', agentId)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n        open: snackbar.open,\n        autoHideDuration: 6000,\n        onClose: handleSnackbarClose,\n        anchorOrigin: {\n          vertical: 'top',\n          horizontal: 'right'\n        },\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          onClose: handleSnackbarClose,\n          severity: snackbar.severity,\n          sx: {\n            width: '100%'\n          },\n          children: snackbar.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 224,\n    columnNumber: 5\n  }, this);\n}\n_s(BusinessDetailsView, \"73+JB8dlCX4HASEXUUQeVFtoYsU=\", false, function () {\n  return [useNavigate];\n});\n_c = BusinessDetailsView;\nexport default BusinessDetailsView;\nvar _c;\n$RefreshReg$(_c, \"BusinessDetailsView\");","map":{"version":3,"names":["React","useState","useEffect","useNavigate","AgentSection","Snackbar","Alert","Box","IconButton","Typography","Container","Paper","Button","ArrowBackIcon","jsxDEV","_jsxDEV","API_BASE_URL","BusinessDetailsView","_s","navigate","businessData","setBusinessData","editFormData","setEditFormData","agents","setAgents","isLoading","setIsLoading","error","setError","isEditing","setIsEditing","snackbar","setSnackbar","open","message","severity","businessId","localStorage","getItem","handleSnackbarOpen","handleSnackbarClose","handleNavigateToLogin","handleLogout","removeItem","fetchData","console","log","businessResponse","fetch","method","credentials","headers","ok","errorData","json","catch","Error","status","fetchedBusinessData","business_name","business_description","address","phone_number","website","agentsResponse","prev","fetchedAgents","err","handleInputChange","e","name","value","target","prevData","handleEditToggle","handleSaveChanges","preventDefault","response","body","JSON","stringify","result","maxWidth","sx","mt","mb","children","p","display","justifyContent","alignItems","fileName","_jsxFileName","lineNumber","columnNumber","color","variant","onClick","mr","gutterBottom","flexGrow","style","marginBottom","onSubmit","htmlFor","type","id","onChange","required","disabled","href","rel","business_id","owner_id","gap","onAgentSelect","agentId","autoHideDuration","onClose","anchorOrigin","vertical","horizontal","width","_c","$RefreshReg$"],"sources":["C:/icmp_events_api/front-end/src/components/BusinessDetailsView/BusinessDetailsView.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport AgentSection from '../AgentSection';\r\nimport { \r\n  Snackbar, \r\n  Alert, \r\n  Box, \r\n  IconButton, \r\n  Typography, \r\n  Container, \r\n  Paper,\r\n  Button\r\n} from '@mui/material';\r\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\r\n\r\n// Define your backend API base URL\r\nconst API_BASE_URL = 'http://localhost:5000';\r\n\r\nfunction BusinessDetailsView() {\r\n  const navigate = useNavigate();\r\n  const [businessData, setBusinessData] = useState(null);\r\n  const [editFormData, setEditFormData] = useState({}); // State for form data\r\n  const [agents, setAgents] = useState([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [snackbar, setSnackbar] = useState({ open: false, message: '', severity: 'success' });\r\n\r\n  // Get the business ID from localStorage instead of hardcoding\r\n  const businessId = localStorage.getItem('businessId');\r\n\r\n  const handleSnackbarOpen = (message, severity = 'success') => {\r\n    setSnackbar({ open: true, message, severity });\r\n  };\r\n\r\n  const handleSnackbarClose = () => {\r\n    setSnackbar({ ...snackbar, open: false });\r\n  };\r\n\r\n  const handleNavigateToLogin = () => {\r\n    navigate('/login');\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    // Clear localStorage\r\n    localStorage.removeItem('userId');\r\n    localStorage.removeItem('businessId');\r\n    localStorage.removeItem('businessApiKey');\r\n    \r\n    // Show logout message\r\n    handleSnackbarOpen('Logged out successfully', 'success');\r\n    \r\n    // Navigate to login page\r\n    navigate('/login');\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      if (!businessId) {\r\n          setError(\"Please login to view business details.\");\r\n          setIsLoading(false);\r\n          return;\r\n      }\r\n      setIsLoading(true);\r\n      setError(null); // Clear previous errors\r\n      console.log(`Fetching data for business ID: ${businessId}`);\r\n\r\n      try {\r\n        // --- Fetch Business Details ---\r\n        const businessResponse = await fetch(`/businesses/${businessId}`, {\r\n          method: 'GET',\r\n          credentials: 'include', // Important to send cookies\r\n          headers: {\r\n            'Accept': 'application/json',\r\n          },\r\n        });\r\n\r\n        if (!businessResponse.ok) {\r\n          const errorData = await businessResponse.json().catch(() => ({})); // Try to get error details\r\n          throw new Error(`HTTP error ${businessResponse.status}: ${errorData.error || errorData.message || 'Failed to fetch business details'}`);\r\n        }\r\n        const fetchedBusinessData = await businessResponse.json();\r\n        console.log(\"Fetched Business Data:\", fetchedBusinessData);\r\n        setBusinessData(fetchedBusinessData);\r\n        setEditFormData({ // Initialize form data when data is fetched\r\n            business_name: fetchedBusinessData.business_name || '',\r\n            business_description: fetchedBusinessData.business_description || '',\r\n            address: fetchedBusinessData.address || '',\r\n            phone_number: fetchedBusinessData.phone_number || '',\r\n            website: fetchedBusinessData.website || ''\r\n        });\r\n\r\n        // --- Fetch Agents ---\r\n        const agentsResponse = await fetch(`/agents?business_id=${businessId}`, {\r\n           method: 'GET',\r\n           credentials: 'include', // Important to send cookies\r\n           headers: {\r\n             'Accept': 'application/json',\r\n           },\r\n        });\r\n\r\n        if (!agentsResponse.ok) {\r\n           const errorData = await agentsResponse.json().catch(() => ({}));\r\n           // Don't throw, maybe just log? Or set a separate error state?\r\n           console.error(`HTTP error ${agentsResponse.status}: ${errorData.message || 'Failed to fetch agents'}`);\r\n           setError(prev => prev ? `${prev} | Failed to fetch agents.` : \"Failed to fetch agents.\"); // Append or set error\r\n           setAgents([]); // Ensure agents list is empty on error\r\n        } else {\r\n            const fetchedAgents = await agentsResponse.json();\r\n            console.log(\"Fetched Agents:\", fetchedAgents);\r\n            setAgents(fetchedAgents);\r\n        }\r\n\r\n      } catch (err) {\r\n        console.error(\"Error fetching data:\", err);\r\n        setError(err.message || \"An unexpected error occurred while fetching data.\");\r\n        setBusinessData(null); // Clear data on error\r\n        setAgents([]);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n\r\n  }, [businessId]); // Re-fetch if businessId changes\r\n\r\n  const handleInputChange = (e) => {\r\n      const { name, value } = e.target;\r\n      setEditFormData(prevData => ({\r\n          ...prevData,\r\n          [name]: value\r\n      }));\r\n  };\r\n\r\n  const handleEditToggle = () => {\r\n      if (!isEditing && businessData) {\r\n          // Reset form data to current business data when entering edit mode\r\n          setEditFormData({\r\n              business_name: businessData.business_name || '',\r\n              business_description: businessData.business_description || '',\r\n              address: businessData.address || '',\r\n              phone_number: businessData.phone_number || '',\r\n              website: businessData.website || ''\r\n          });\r\n      }\r\n      setIsEditing(!isEditing);\r\n      setError(null); // Clear errors when toggling mode\r\n  };\r\n\r\n  const handleSaveChanges = async (e) => {\r\n      e.preventDefault(); // Prevent default form submission\r\n      setIsLoading(true); // Indicate saving process\r\n      setError(null);\r\n      console.log(\"Saving changes:\", editFormData);\r\n\r\n      try {\r\n           const response = await fetch(`${API_BASE_URL}/businesses/${businessId}`, {\r\n               method: 'PUT',\r\n               credentials: 'include',\r\n               headers: {\r\n                   'Content-Type': 'application/json',\r\n                   'Accept': 'application/json',\r\n               },\r\n               body: JSON.stringify(editFormData)\r\n           });\r\n\r\n           if (!response.ok) {\r\n                const errorData = await response.json().catch(() => ({}));\r\n                throw new Error(`HTTP error ${response.status}: ${errorData.message || 'Failed to save changes'}`);\r\n           }\r\n\r\n           const result = await response.json();\r\n           console.log(\"Save successful:\", result);\r\n\r\n           // Optimistically update local state, or re-fetch data\r\n           setBusinessData(prevData => ({ ...prevData, ...editFormData }));\r\n           setIsEditing(false);\r\n\r\n      } catch (err) {\r\n          console.error(\"Error saving changes:\", err);\r\n          setError(err.message || \"An unexpected error occurred while saving.\");\r\n      } finally {\r\n          setIsLoading(false); // Finish loading indicator\r\n      }\r\n  };\r\n\r\n  if (isLoading && !businessData) { // Show initial loading\r\n    return (\r\n      <Container maxWidth=\"lg\" sx={{ mt: 4, mb: 4 }}>\r\n        <Paper sx={{ p: 3, display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\r\n          <Typography>Loading business details...</Typography>\r\n        </Paper>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  // Show error prominently if one occurred\r\n  if (error && !isEditing) { // Don't block editing form with load errors\r\n    return (\r\n      <Container maxWidth=\"lg\" sx={{ mt: 4, mb: 4 }}>\r\n        <Paper sx={{ p: 3 }}>\r\n          <Typography color=\"error\">Error: {error}</Typography>\r\n          <Button \r\n            variant=\"contained\" \r\n            color=\"primary\" \r\n            onClick={handleNavigateToLogin} \r\n            sx={{ mt: 2 }}\r\n          >\r\n            Return to Login\r\n          </Button>\r\n        </Paper>\r\n      </Container>\r\n    );\r\n  }\r\n\r\n  if (!businessData && !isLoading) { // Handle case where loading finished but no data (and no specific load error)\r\n      return <div>No business data found or failed to load.</div>;\r\n  }\r\n  // Render component content only if businessData is available\r\n  if (!businessData) return null; // Or a placeholder/skeleton UI\r\n\r\n  return (\r\n    <Container maxWidth=\"lg\" sx={{ mt: 4, mb: 4 }}>\r\n      <Paper sx={{ p: 3, mb: 4 }}>\r\n        <Box sx={{ display: 'flex', alignItems: 'center', mb: 3 }}>\r\n          <IconButton onClick={handleLogout} sx={{ mr: 1 }}>\r\n            <ArrowBackIcon />\r\n          </IconButton>\r\n          <Typography variant=\"h5\" gutterBottom sx={{ flexGrow: 1, mb: 0 }}>\r\n            Business Details\r\n          </Typography>\r\n        </Box>\r\n        \r\n        {/* Display save errors specifically above the form */}\r\n        {isEditing && error && <div style={{ color: 'red', marginBottom: '10px' }}>Save Error: {error}</div>}\r\n        {/* Indicate loading state during save */}\r\n        {isEditing && isLoading && <div>Saving...</div>}\r\n\r\n        {isEditing ? (\r\n          // --- Edit Mode ---\r\n          <form onSubmit={handleSaveChanges}>\r\n              <div>\r\n                  <label htmlFor=\"business_name\">Name:</label>\r\n                  <input\r\n                      type=\"text\"\r\n                      id=\"business_name\"\r\n                      name=\"business_name\"\r\n                      value={editFormData.business_name}\r\n                      onChange={handleInputChange}\r\n                      required // Assuming name is required\r\n                  />\r\n              </div>\r\n              <div>\r\n                   <label htmlFor=\"business_description\">Description:</label>\r\n                  <textarea\r\n                      id=\"business_description\"\r\n                      name=\"business_description\"\r\n                      value={editFormData.business_description}\r\n                      onChange={handleInputChange}\r\n                  />\r\n              </div>\r\n               <div>\r\n                   <label htmlFor=\"address\">Address:</label>\r\n                  <input\r\n                      type=\"text\"\r\n                      id=\"address\"\r\n                      name=\"address\"\r\n                      value={editFormData.address}\r\n                      onChange={handleInputChange}\r\n                  />\r\n              </div>\r\n               <div>\r\n                   <label htmlFor=\"phone_number\">Phone:</label>\r\n                  <input\r\n                      type=\"tel\" // Use tel type for phone numbers\r\n                      id=\"phone_number\"\r\n                      name=\"phone_number\"\r\n                      value={editFormData.phone_number}\r\n                      onChange={handleInputChange}\r\n                  />\r\n              </div>\r\n               <div>\r\n                   <label htmlFor=\"website\">Website:</label>\r\n                  <input\r\n                      type=\"url\" // Use url type for websites\r\n                      id=\"website\"\r\n                      name=\"website\"\r\n                      value={editFormData.website}\r\n                      onChange={handleInputChange}\r\n                  />\r\n              </div>\r\n              {/* Add inputs for address, phone, website */}\r\n              <button type=\"submit\" disabled={isLoading}>Save Changes</button>\r\n              <button type=\"button\" onClick={handleEditToggle} disabled={isLoading}>Cancel</button>\r\n          </form>\r\n        ) : (\r\n          // --- View Mode ---\r\n          <div>\r\n            <p><strong>Name:</strong> {businessData.business_name}</p>\r\n            <p><strong>Description:</strong> {businessData.business_description || '-'}</p>\r\n            <p><strong>Address:</strong> {businessData.address || '-'}</p>\r\n            <p><strong>Phone:</strong> {businessData.phone_number || '-'}</p>\r\n            <p><strong>Website:</strong> {businessData.website ? <a href={businessData.website} target=\"_blank\" rel=\"noopener noreferrer\">{businessData.website}</a> : '-'}</p>\r\n            <hr/>\r\n            <p><strong>Business ID:</strong> {businessData.business_id}</p>\r\n            <p><strong>Owner ID:</strong> {businessData.owner_id}</p>\r\n            <Box sx={{ display: 'flex', gap: 2, mt: 2 }}>\r\n              <Button \r\n                variant=\"contained\" \r\n                color=\"primary\" \r\n                onClick={handleEditToggle}\r\n              >\r\n                Edit Details\r\n              </Button>\r\n              <Button \r\n                variant=\"outlined\" \r\n                color=\"error\" \r\n                onClick={handleLogout}\r\n              >\r\n                Logout\r\n              </Button>\r\n            </Box>\r\n          </div>\r\n        )}\r\n\r\n        <hr />\r\n\r\n        {/* Replace the old agent list with our AgentSection component */}\r\n        <AgentSection \r\n          handleSnackbarOpen={handleSnackbarOpen} \r\n          onAgentSelect={(agentId) => console.log('Selected agent:', agentId)}\r\n        />\r\n        \r\n        {/* Snackbar for notifications */}\r\n        <Snackbar \r\n          open={snackbar.open}\r\n          autoHideDuration={6000}\r\n          onClose={handleSnackbarClose}\r\n          anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\r\n        >\r\n          <Alert onClose={handleSnackbarClose} severity={snackbar.severity} sx={{ width: '100%' }}>\r\n            {snackbar.message}\r\n          </Alert>\r\n        </Snackbar>\r\n      </Paper>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default BusinessDetailsView;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}